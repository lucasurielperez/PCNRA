// Etapa 1: Movimiento (arar)
let shakes = 0;
window.addEventListener('devicemotion', (event) => {
  if (stage === 0) {
    // Verifica si el evento tiene datos
    if (!event.acceleration) {
      instructions.textContent = "No se detecta aceleración. ¿Permisos habilitados?";
      return;
    }

    // Obtener valores de aceleración
    const accX = event.acceleration.x || 0;
    const accY = event.acceleration.y || 0;
    const accZ = event.acceleration.z || 0;

    // Mostrar valores en pantalla para depurar (opcional, quítalo después)
    instructions.textContent = `Ara la tierra - X: ${accX.toFixed(2)}, Y: ${accY.toFixed(2)}, Z: ${accZ.toFixed(2)}`;

    // Detectar movimiento significativo
    if (Math.abs(accX) > 5 || Math.abs(accY) > 5 || Math.abs(accZ) > 5) {
      shakes++;
      progress = shakes / 10; // 10 sacudidas para completar
      updateProgressBar();
      if (shakes >= 10) {
        nextStage();
      }
    }
  }
}, { passive: true });